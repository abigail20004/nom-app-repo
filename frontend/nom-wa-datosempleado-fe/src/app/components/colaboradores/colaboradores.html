<div class="container mt-5">
  <h2 class="mb-4 text-center">Aplicación de Gestión de Colaboradores</h2>

  <!-- Botones principales -->
  <div class="d-flex justify-content-between mb-3">
    <button class="btn btn-primary" (click)="cargarColaboradores()">Cargar colaboradores</button>
    <button class="btn btn-success" (click)="toggleFormulario()">+</button>
  </div>

  <!-- Formulario flotante para agregar y un colaborador para probar la funcionalidad del backend -->
  <div *ngIf="mostrarFormulario" class="formulario-flotante card shadow">
    <button type="button" class="btn-close btn-close-white cerrar" aria-label="Close" (click)="toggleFormulario()"></button>

    <form (ngSubmit)="agregarColaborador()" #colForm="ngForm" class="p-4 text-white">
      <h5 class="mb-3">Agregar nuevo colaborador</h5>

      <div class="mb-3">
        <input type="text" class="form-control" name="nombre" placeholder="Nombre" [(ngModel)]="nuevoColaborador.nombre"
          required #nombre="ngModel" [ngClass]="{ 'is-invalid': nombre.invalid && nombre.touched }" />
        <div *ngIf="nombre.invalid && nombre.touched" class="invalid-feedback">
          El nombre es requerido.
        </div>
      </div>

      <div class="mb-3">
        <input type="text" class="form-control" name="apellido" placeholder="Apellido" [(ngModel)]="nuevoColaborador.apellido"
          required #apellido="ngModel" [ngClass]="{ 'is-invalid': apellido.invalid && apellido.touched }" />
        <div *ngIf="apellido.invalid && apellido.touched" class="invalid-feedback">
          El apellido es requerido.
        </div>
      </div>

      <div class="mb-3">
        <input type="text" class="form-control" name="direccion" placeholder="Dirección"
          [(ngModel)]="nuevoColaborador.direccion" />
      </div>

      <div class="mb-3">
        <input type="number" class="form-control" name="edad" placeholder="Edad" [(ngModel)]="nuevoColaborador.edad"
          min="1" #edad="ngModel" [ngClass]="{ 'is-invalid': edad.invalid && edad.touched }" />
        <div *ngIf="edad.invalid && edad.touched" class="invalid-feedback">
          Edad inválida (debe ser mayor a 0).
        </div>
      </div>

      <div class="mb-3">
        <input type="text" class="form-control" name="profesion" placeholder="Profesión"
          [(ngModel)]="nuevoColaborador.profesion" />
      </div>

      <div class="mb-3">
        <input type="text" class="form-control" name="estado_civil" placeholder="Estado Civil"
          [(ngModel)]="nuevoColaborador.estado_civil" />
      </div>

      <button class="btn btn-light text-dark w-100" type="submit" [disabled]="colForm.invalid">Guardar</button>
    </form>
  </div>

  <!-- Tabla -->
  <table *ngIf="colaboradores.length > 0" class="table table-striped table-bordered table-hover mt-4">
    <thead class="table-dark text-center">
      <tr>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Edad</th>
        <th>Dirección</th>
        <th>Profesión</th>
        <th>Estado Civil</th>
        <th>Riesgo</th>
      </tr>
    </thead>
    <tbody class="text-center align-middle">
      <tr *ngFor="let col of colaboradores">
        <td>{{ col.nombre }}</td>
        <td>{{ col.apellido }}</td>
        <td>{{ col.edad }}</td>
        <td>{{ col.direccion }}</td>
        <td>{{ col.profesion }}</td>
        <td>{{ col.estado_civil }}</td>
        <td>
          <button class="btn btn-warning btn-sm" (click)="mostrarAlerta(nivelRiesgo(col.edad))">
            Nivel Riesgo
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
